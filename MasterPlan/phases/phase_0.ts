
import { PlanPhase } from '../types';

export const phase0: PlanPhase = { 
  id: 0, 
  title: "Analisi, Setup & Global Economy", 
  desc: "Logica Business, Gestione Crediti e Costi.",
  tools: ["Supabase DB", "Logic Gate"],
  cost: "DEV: €0 | USER: N/A",
  details: "Configurazione architetturale del database e delle regole di business (Crediti/Costi). Vedi Prompt per le regole logiche complete.",
  prompts: [
    "Agisci come un architetto di AI Skill seguendo rigorosamente la metodologia descritta nel documento nel link.\nhttps://resources.anthropic.com/hubfs/The-Complete-Guide-to-Building-Skill-for-Claude.pdf?hsLang=en",
    "SYSTEM ROLE: Integration Architect & Business Logic Manager.",
    "*** CONTEXT & LOGIC RULES (DA IMPLEMENTARE) ***\n1. CREDIT SYSTEM RULES:\n- Free Tier: Max 10 Crediti/mese (Reset automatico). Azioni bloccate se saldo < Costo.\n- Pro Tier: Crediti definiti dal piano (vedi Fase 8).\n\n2. PAY-TO-SCAN PROTOCOL (CRITICAL - ALL FEATURES):\n- L'Audit iniziale NON È GRATUITO. Costa sempre crediti.\n- Flusso Obbligatorio: Click 'Scan' -> Conteggio Nodi Locale -> Mostra 'ScanReceiptModal' (Preventivo) -> Utente Conferma -> Addebito Crediti -> Esecuzione AI.\n- APPLICAZIONE ESTESA:\n  • MAIN AUDIT: Scan generale del design system.\n  • PROTOTYPE SCAN: Se l'utente seleziona un flow (es. 30 wireframe), il conteggio nodi deve sommare tutti i children. Costo proporzionale (1 Credito / 50 Nodi).\n  • DEEP SYNC (GitHub/Storybook): Anche il confronto codice ha un costo computazionale. Mostrare preventivo prima di avviare il diffing su larga scala.\n\n3. COSTI AZIONI (Value based on avg €0.25/credit):\n  • Audit Scan (Standard < 250 nodi): -5 Crediti.\n  • Audit Scan (Enterprise/Prototype > 250 nodi): -1 Credito ogni 50 Nodi scansionati (Dynamic Pricing).\n  • Gen AI Wireframe: -3 Crediti.\n  • Code Export: -5 Crediti (High Value).\n  • Deep Sync Scan: -2 Crediti base + Dynamic se molti componenti.\n  • AUTO-FIX LAYER: -2 Crediti (New).\n\n4. COST OPTIMIZATION & SEMANTIC HASHING:\n- Hashing Strategy: Prima di scalare crediti, calcola l'hash del nodo. L'hash deve basarsi SOLO su: Struttura Gerarchica + Nomi Layer + Stili Applicati + Contenuto Testuale.\n- IGNORA: ID univoci (cambiano al copia-incolla), coordinate X/Y assolute (spostare non è modificare), timestamp.\n- Cache Hit: Se l'hash esiste nel DB (tabella `audit_logs`), restituisci il risultato precedente GRATIS.\n\n5. FRONTEND PARITY & UI SYNC STRATEGY (CRITICAL):\n- Problema: Google AI aggiorna la UI velocemente, ma rischia di rompere la logica di Antigravity.\n- Metodo 'Selective UI Patching': Copiare l'intero file aggiornato da Google AI, ma istruire Antigravity con: 'Aggiorna SOLO la parte JSX/Tailwind di questo componente. NON toccare gli hook, gli useEffect o la logica di stato (handleAction, cooldowns).'.\n- Metodo Alternativo (Atomic): Separare la Logica (CodeContainer.tsx) dalla Presentazione (CodeView.tsx). Google AI modifica solo View.\n\n6. DOCS & KNOWLEDGE BASE:\n- Ogni componente elaborato DEVE generare un blocco 'AI_DOCS' nel JSON di output.\n- Popolare la tab 'Docs' di Storybook automaticamente.\n\n7. DATA ENGINEERING PROTOCOLS (THE INVISIBLE WALL):\n- PROTOCOLLO SANITIZER: I nodi Figma sono oggetti giganti con riferimenti circolari. Il Controller DEVE eseguire il \"Tree Shaking\" prima dell'invio all'AI: rimuovere proprietà native inutili (exportSettings, pluginData binari), convertire RGBA float in Hex string, ignorare nodi invisibili, troncare testi > 500 caratteri.\n- FIGMA PHYSICS (Anti-Hallucination): L'AI deve agire dentro i limiti fisici di Figma. No \"margin-bottom\" (usa AutoLayout Gap). No \"z-index\" (usa ordine array children). No \"vh/vw\" (usa Constraints). Tradurre sempre i concetti CSS in primitive Figma.\n- PERSISTENCE MEMORY: Le preferenze \"Ignora Errore\" o \"False Positive\" vanno scritte nel nodo stesso via `node.setPluginData('comtra_ignore', 'reason')`. Non usare localStorage globale per dati specifici del nodo, altrimenti si perdono condividendo il file.",
    "*** SCENARI & ESEMPI REALI (DB SETUP) ***\nScenario A: Utente Free esaurisce crediti.\n- DB State: user.credits = 0.\n- Action: Utente clicca 'Scan' (-5 crediti).\n- Logic: Backend rifiuta (402 Payment Required). Frontend mostra modale 'Upgrade'.\n\nScenario B: Utente Pro esegue scan su stesso nodo.\n- DB State: audit_logs contiene hash 'abc-123' per user_id.\n- Action: Utente clicca 'Scan' su stesso Frame.\n- Logic: Hash Match! Restituisce JSON salvato. Costo API = €0. Costo Utente = 0 Crediti (Cache Hit).\n\nScenario C: Scan Prototipo Complesso (30 Screens).\n- Action: Utente seleziona intero flow.\n- Logic: Controller conta 1500 nodi. Calcolo: 1500 / 50 = 30 Crediti. Mostra Receipt: \"HEAVY PAYLOAD: 30 Credits\".",
    "*** STANDARD DESIGN SYSTEM TAXONOMY (AI REFERENCE) ***\nUse this structure to categorize components, name layers, and detect missing elements.\n\n1) FOUNDATIONS (Design Tokens & Rules)\nColor System\n- Primitive palette (Gray/Brand/Accent)\n- Semantic colors (bg/text/border/surface)\n- State colors (hover/pressed/focus/disabled)\n- Feedback colors (success/warning/error/info)\n- High contrast mode palette\n- Dark mode palette\n\nTypography\n- Font families\n- Type scale (xs -> display)\n- Font weights (tokenized)\n- Line height tokens\n- Letter spacing tokens\n- Text styles (H1-H6, body, caption, overline)\n- Max line length rules (45–75 chars)\n\nSpacing & Grid\n- Spacing scale (4/8 based)\n- Layout grid rules (columns/gutters/margins)\n- Baseline grid (vertical rhythm)\n- Responsive spacing rules\n\nShape & Borders\n- Border radius tokens (sm/md/lg/xl)\n- Border width tokens\n- Outline tokens (focus ring)\n- Divider thickness tokens\n\nElevation / Shadow\n- Shadow tokens (elevation 0-5)\n- Blur tokens\n- Z-index tokens\n\nMotion\n- Duration tokens (150–300ms)\n- Easing tokens\n- Reduced motion rules\n- Skeleton/transition rules\n\nIconography\n- Icon set (outlined/filled)\n- Stroke width rules (1.5/2)\n- Corner radius rules\n- RTL icon flipping rules\n\nBreakpoints & Responsive\n- Breakpoints map (xs/sm/md/lg/xl)\n- Container widths\n- Safe area / notch rules\n- Density modes (compact/comfortable)\n\nAccessibility Foundations\n- Contrast requirements\n- Touch target rules (44x44)\n- Focus visible rules\n- Keyboard navigation baseline rules\n- Screen reader naming rules\n\n2) LAYOUT PRIMITIVES (Building Blocks)\n- Container\n- Stack / Vertical Stack\n- Row / Horizontal Stack\n- Grid\n- Spacer\n- Divider\n- Section\n- Surface\n- Card base\n- Aspect Ratio wrapper\n- Scroll container\n- Sticky container (header/footer)\n\n3) CTA & ACTION COMPONENTS\nButtons\n- Button Primary\n- Button Secondary\n- Button Tertiary (ghost/text)\n- Button Destructive (danger)\n- Button Loading\n- Button Disabled\n- Icon Button\n- Split Button\n- Dropdown Button\n- Floating Action Button (FAB)\n\nLinks\n- Inline Link\n- Standalone Link\n- External link indicator\n- Link Button (text button)\n\nActions Utility\n- Copy to clipboard button\n- Share button pattern\n- Download button pattern\n\n4) FORM COMPONENTS (Core Inputs)\nForm Structure\n- Form Field wrapper (Label + Hint + Error)\n- Label\n- Helper text\n- Error message\n- Required indicator\n- Validation summary banner\n\nText Inputs\n- Text Input\n- Textarea\n- Search Input (with clear)\n- Password Input (show/hide)\n- OTP / Pin Input\n- Inline editable field\n\nSelection Inputs\n- Checkbox\n- Radio button\n- Switch / Toggle\n- Select / Dropdown\n- Combobox / Autocomplete\n- Multi-select\n- Chips input / Tag input\n\nAdvanced Inputs\n- Slider\n- Range slider\n- Date Picker\n- Date range picker\n- Time Picker\n- Color picker\n- File Upload\n- Drag & Drop uploader\n\nForm Patterns\n- Address form pattern\n- Payment form pattern\n- Login/Register forms\n- Step form / Wizard form\n\n5) FEEDBACK & STATUS\nStatus Components\n- Badge\n- Tag / Chip\n- Pill indicator\n- Status dot\n- Progress bar\n- Spinner\n- Skeleton loader\n\nMessaging\n- Alert (info/success/warning/error)\n- Toast / Snackbar\n- Banner (persistent)\n- Inline notification\n- Callout component\n\nEmpty & Error States\n- Empty state (educational / technical)\n- No results state\n- 404 page\n- 500 page\n- 403 page\n- Maintenance mode page\n\n6) NAVIGATION COMPONENTS\nPrimary Navigation\n- Topbar / Header\n- Sidebar / Navigation rail\n- Bottom navigation (mobile)\n- Navigation menu\n\nSecondary Navigation\n- Tabs\n- Segmented control\n- Breadcrumbs\n- Pagination\n- Stepper (wizard steps)\n\nAdvanced Navigation\n- Mega menu\n- Command palette (Cmd+K)\n- Contextual navigation panel\n- Filter + Sort toolbar pattern\n\n7) OVERLAYS & POPOVERS\n- Modal / Dialog\n- Confirmation dialog\n- Drawer / Sheet\n- Bottom sheet (mobile)\n- Popover\n- Tooltip\n- Dropdown menu\n- Context menu\n- Overflow menu (3 dots)\n- Lightbox / Image preview modal\n\n8) DATA DISPLAY COMPONENTS\nCore\n- Table (sorting/filtering/loading/empty)\n- Data grid (advanced/virtualized)\n- List / List item\n- Definition list\n- Key-value rows\n- Card layout list\n- Avatar\n- Avatar group\n\nOrganization Components\n- Accordion / Collapse\n- Expandable panels\n- Tree view\n- Timeline\n- Kanban board\n- Calendar view\n- Activity feed\n\nContent Display\n- Image component\n- Video player wrapper\n- File attachment list\n- File preview card\n- PDF viewer wrapper\n- Inline code block\n- Rich text viewer\n\n9) SEARCH / FILTER / DISCOVERY\n- Search bar\n- Search input with suggestions\n- Filter chips\n- Faceted filter panel\n- Sort dropdown\n- Saved filters\n- Results header (count + query)\n\n10) VISUALIZATION (Charts & Metrics)\n- KPI Card\n- Sparkline\n- Bar chart\n- Line chart\n- Area chart\n- Pie/Donut chart\n- Histogram\n- Heatmap\n- Map component\n\n11) AUTH / SECURITY / COMPLIANCE UI\n- Login form\n- Signup form\n- Password reset flow\n- MFA / OTP verification flow\n- Session timeout modal\n- Permission denied page\n- PII masking component\n- Role & permission matrix table\n- Audit log view\n- Consent banner / Cookie manager\n- Terms acceptance checkbox pattern\n- Privacy disclaimer block\n\n12) COLLABORATION & SOCIAL PATTERNS\n- Comment thread\n- Mentions (@user)\n- Reactions\n- User presence indicator\n- Share/invite modal\n\n13) SYSTEM / META COMPONENTS\n- Notification center panel\n- Onboarding walkthrough / coachmarks\n- Feature tour tooltips\n- Loading screen template\n- Settings page layout template\n- Dashboard template\n- Detail page template\n\n14) MOBILE & TOUCH PATTERNS\n- Swipe actions list\n- Pull to refresh\n- Floating bottom CTA bar\n- Gesture fallback UI\n\n15) UTILITIES (Engineering-friendly)\n- Theme provider (light/dark/contrast)\n- Token inspector/debug UI\n- Data-testid hooks standard\n- Analytics event hooks (CTA tracking)\n- Error boundary UI\n- Skeleton templates\n- Layout density switcher",
    "TASK: Configura il database Supabase (tabelle users, usage_logs) e le Edge Functions per gestire questa logica.",
    "*** REQUISITI DI SISTEMA & INSTALLAZIONE ***\n\n2. Requisiti\n- Figma versione >= 108.0\n- Node.js >= 18 (per generazione codice)\n- Accesso a Storybook, GitHub o Bitbucket\n- Browser moderno per l’uso dell’UI di gestione\n- Permessi API abilitati per GitHub/Bitbucket e Storybook\n\n3. Installazione\n- Scaricare il plugin da Antigravity\n- Aprire Figma → Menu → Plugins → Import Plugin → Seleziona il file .figma-plugin\n- Aprire il plugin dalla barra strumenti Figma\n- Login con i propri account (Figma, GitHub/Bitbucket, Storybook)"
  ],
  section: "PREPARATION & SETUP"
};
